<!-- ブック詳細のファイル -->
<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<header class="navbar nabvar-fixed-top navbar-inverse">
		<div class="container">
			<span class="col-xs-7" style="font-size: 20px; color: #fff ;">Bookers</span>
			<ul class="col-xs-5">
				<% if user_signed_in? %>
					<li style="display: inline-block; padding: 15px;">
						<%= link_to " Home",user_path(current_user),{class: "text-muted glyphicon glyphicon-home" } %>
					</li>
					<li style="display: inline-block; padding: 15px;">
						<%= link_to " Users",users_path,{class: "text-muted glyphicon glyphicon-user"} %>
		   			</li>
		   			<li style="display: inline-block; padding: 15px;">
		   				<%= link_to " Books",books_path,{class: "text-muted glyphicon glyphicon-book"} %>
		   			</li>
					<li style="display: inline-block; padding: 15px;">
		        		<%= link_to " logout", destroy_user_session_path, method: :delete ,:class => "text-muted glyphicon glyphicon-log-out" %>
		   			</li>
				<% else %>
					<li>
						<a href="/">Home</a>
					</li>
					<li>
						<a href="/home/about">About</a>
					</li>
					<li class="">
				        <%= link_to "sign up", new_user_registration_path %>
				    </li>
				    <li class="">
				        <%= link_to "login", new_user_session_path %>
				    </li>
				<%  end %>
			</ul>
		</div>
	</header>
	<% if flash[:notice] %>
        <%= flash[:notice] %>
    <% end %>
    <div class="container">
		<div class="col-xs-3" style="padding: 0 15px;">
				<h2 style="margin: 20px 0 10px 0;">User info</h2>
				<div class="img-box">
					<%= attachment_image_tag @user, :profile_image, :fill, 100, 100, format: 'jpeg', fallback: "no_image.png" %>
				</div>
				<table class="table table-border">
					<th>Name</th>
					<td><%= @user.name %></td>
				</table>
				<table class="table table-border">
					<th>Introduction</th>
					<td>
						<%= @user.introduction %>
					</td>
				</table>
				<div class="row">
				<%= link_to "",edit_user_path(@user.id), {class: "col-xs-12 btn btn-default glyphicon glyphicon-wrench"}%>
				</div>
				<h2 style="margin: 20px 0 10px 0;">New Book</h2>
				<%= form_for (@book) do |f| %>
				<div class="row">
					<label>Title</label>
					<%= f.text_field :title, {class: "col-xs-12"} %>
				</div>
				<div class="row" style="margin-bottom: 10px;">
					<label>Opinion</label>
					<%= f.text_area :body, {class: "col-xs-12"} %>
				</div>
				<div class="row">
					<%= f.submit "Create Book",{class: "btn btn-primary col-xs-12"} %>
				</div>
			<% end %>
		</div>
		<div class="col-xs-9">
			<h2 style="margin: 20 0 10px 0;">Books detail</h2>
			<table class="table">
				<tr>
					<!-- 画像リンクをつけたい -->
					<td>
						<div><a><%= attachment_image_tag @user, :profile_image, :fill, 100, 100, format: 'jpeg', fallback: "no_image.png" %></a>
						</div>
						<div>
							<%= link_to @user.name, user_path(@user)%>
						</div>
					</td>
					<td><%= link_to @book_show.title, book_path(@book_show) %></td>
					<td><%= @book_show.body %></td>
					<% if @book_show.favorited_by?(current_user) %>
						<td>
							<%= link_to favorite_path(@book_show), method: :delete do %>
								<span>❤️</span>
								<%= @book_show.favorites.count %>
							<% end %>
						</td>
					<% else %>
						<td>
							<%= link_to favorites_path(@book_show), method: :post do %>
								<span>♡</span>
								<%= @book_show.favorites.count %>
							<% end %>
						</td>
					<% end %>
					<% if current_user == @user %>
						<td><%= link_to "edit", edit_book_path %></td>
						<td><%= link_to "destroy", book_path, method: :delete %></td>
					<% end %>
					<td>
						コメント数 : <%= @book_show.book_comments.count %>
					</td>
				</tr>
			</table>
			<div class="col-xs-12">
				<div class="col-xs-6">
					<h3><strong>コメント一覧</strong></h3>
					<% @book_show.book_comments.each do |comments| %>
						<div style="border: 1px solid black; padding: 5px 10px;">
							<%= comments.comment %>
						</div>
						<% if current_user.id == comments.user_id %>
							<%= link_to "コメント削除", book_book_comments_path(@book_show.id), method: :delete %>
						<% end %>
						<br>
						<br>
					<% end %>
				</div>
				<div class="col-xs-6">
					<h3><strong>コメントを投稿する</strong></h3>
					<%= form_for [@book_show, @book_comment] do |c| %>
						<%= c.text_area :comment, style: "width: 400px; height: 200px;" %>
						<%= c.submit "送信" %>
					<% end %>
				</div>
			</div>
		</div>
	<div class="row footer">
	  <div class="col-xs-3 col-xs-offset-9">
	    <p>CopyRight Infratop.inc</p>
	</div>
</div>
</body>
</html>